# -*- coding: utf-8 -*-
Message('Подключите формирователь на первый канал осциллографа') 
#1 dcv
Param_wj312('1', 'ROUT:SIGN:IMP 1E+06', 'SCOP:SHAP DC', 'MLEN 500', 'TDIV 1ms')
Call_oscill('VOLT 0.015', 'C1: VDIV 5mv', 'MSRA?', 'dcv_1', 'gdcv_1', 2.425)
Call_oscill('VOLT -0.015', 'C1: VDIV 5mv', 'MSRB?', 'dcv_2', 'gdcv_2', 2.425)
Call_oscill('VOLT 0.03', 'C1: VDIV 10mv', 'MSRA?', 'dcv_3', 'gdcv_3', 2.85)
Call_oscill('VOLT -0.03', 'C1: VDIV 10mv', 'MSRB?', 'dcv_4', 'gdcv_4', 2.85)
Call_oscill('VOLT 0.3', 'C1: VDIV 100mv', 'MSRA?', 'dcv_5', 'gdcv_5', 10.5)
Call_oscill('VOLT -0.3', 'C1: VDIV 100mv', 'MSRB?', 'dcv_6', 'gdcv_6', 10.5)
Call_oscill('VOLT 1.5', 'C1: VDIV 500mv', 'MSRA?', 'dcv_7', 'gdcv_7', 44.5)
Call_oscill('VOLT -1.5', 'C1: VDIV 500mv', 'MSRB?', 'dcv_8', 'gdcv_8', 44.5)
Call_oscill('VOLT 3.0', 'C1: VDIV 1', 'MSRA?', 'dcv_9', 'gdcv_9', 87.0)
Call_oscill('VOLT -3.0', 'C1: VDIV 1', 'MSRB?', 'dcv_10', 'gdcv_10', 87.0)
Call_oscill('VOLT 30.0', 'C1: VDIV 10', 'MSRA?', 'dcv_11', 'gdcv_11', 852.0)
Call_oscill('VOLT -30.0', 'C1: VDIV 10', 'MSRB?', 'dcv_12', 'gdcv_12', 852.0)
#1 trise
Message('Подключите внешнию нагрузку 50 Ом на первый канал осциллографа')
Param_wj312('1', 'ROUT:SIGN:IMP 50', 'SCOP:SHAP EDGE', 'MLEN 50', 'TDIV 5ns')
Call_oscill('VOLT 0.5', '', ' MSRC?', 'tr_1', '', 3.5)
#1 period
Param_wj312('1', 'ROUT:SIGN:IMP 50', 'SCOP:SHAP SIN', 'MLEN 500', 'TDIV 20ms')
Call_oscill('VOLT 0.6', 'C1: VDIV 100mv', 'MSRD?', 'frq_1', '', 100.0)
#2 dcv
Message('Подключите формирователь на второй канал осциллографа')
Param_wj312('2', 'ROUT:SIGN:IMP 1E+06', 'SCOP:SHAP DC', 'MLEN 500', 'TDIV 1ms')
Call_oscill('VOLT 0.015', 'C2: VDIV 5mv', 'MSRA?', 'dcv_13', 'gdcv_13', 2.425)
Call_oscill('VOLT -0.015', 'C2: VDIV 5mv', 'MSRB?', 'dcv_14', 'gdcv_14', 2.425)
Call_oscill('VOLT 0.03', 'C2: VDIV 10mv', 'MSRA?', 'dcv_15', 'gdcv_15', 2.85)
Call_oscill('VOLT -0.03', 'C2: VDIV 10mv', 'MSRB?', 'dcv_16', 'gdcv_16', 2.85)
Call_oscill('VOLT 0.3', 'C2: VDIV 100mv', 'MSRA?', 'dcv_17', 'gdcv_17', 10.5)
Call_oscill('VOLT -0.3', 'C2: VDIV 100mv', 'MSRB?', 'dcv_18', 'gdcv_18', 10.5)
Call_oscill('VOLT 1.5', 'C2: VDIV 500mv', 'MSRA?', 'dcv_19', 'gdcv_19', 44.5)
Call_oscill('VOLT -1.5', 'C2: VDIV 500mv', 'MSRB?', 'dcv_20', 'gdcv_20', 44.5)
Call_oscill('VOLT 3.0', 'C2: VDIV 1', 'MSRA?', 'dcv_21', 'gdcv_21', 87.0)
Call_oscill('VOLT -3.0', 'C2: VDIV 1', 'MSRB?', 'dcv_22', 'gdcv_22', 87.0)
Call_oscill('VOLT 30.0', 'C2: VDIV 10', 'MSRA?', 'dcv_23', 'gdcv_23', 852.0)
Call_oscill('VOLT -30.0', 'C2: VDIV 10', 'MSRB?', 'dcv_24', 'gdcv_24', 852.0)
#2 trise
Message('Подключите внешнию нагрузку 50 Ом на первый канал осциллографа')
Param_wj312('2', 'ROUT:SIGN:IMP 50', 'SCOP:SHAP EDGE', 'MLEN 50', 'TDIV 5ns')
Call_oscill('VOLT 0.5', '', 'MSRC?', 'tr_2', '', 3.5)
#2 period
Param_wj312('2', 'ROUT:SIGN:IMP 50', 'SCOP:SHAP SIN', 'MLEN 500', 'TDIV 20ms')
Call_oscill('VOLT 0.6', 'C2: VDIV 100mv', 'MSRD?', 'frq_2', '', 100.0)
Message('Калибровка завершена')
