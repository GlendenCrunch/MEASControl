# -*- coding: utf-8 -*-
for j in range(1,9,1):
    Message(f'Подключите формирователь на КАНАЛ №{j} осциллографа')
    # res
    Reset()
    Param_osc(f'{j}', '', 'CONF:RES', 'TDIV 1ms', f'C{j}:CPL DC50')
    Call_oscill('ROUT:SIGN:IMP 50', f'C{j}:VDIV 50mv', 'READ?', f'r{j}_1', '', 1)
    Call_oscill('ROUT:SIGN:IMP 50', f'C{j}:VDIV 200mv', 'READ?', f'r{j}_2', '', 1)
    Param_osc(f'{j}', '', 'CONF:RES', 'TDIV 1ms', f'C{j}:CPL DC1M')
    Call_oscill('ROUT:SIGN:IMP 1E+06', f'C{j}:VDIV 50mv', 'READ?', f'r{j}_3', '', 20000)
    Call_oscill('ROUT:SIGN:IMP 1E+06', f'C{j}:VDIV 200mv', 'READ?', f'r{j}_4', '', 20000)
    # dcv
    Reset()
    Param_osc(f'{j}', 'ROUT:SIGN:IMP 1E+06', 'SCOP:SHAP DC', 'TDIV 1ms', f'C{j}:CPL DC50')
    Call_oscill('VOLT 0.006', f'C{j}:VDIV 2mv', f'C{j}:PAVA? MEAN', f'dcv{j}_50_1', '', 0.00108)
    Call_oscill('VOLT -0.006', f'C{j}:VDIV 2mv', f'C{j}:PAVA? MEAN', f'dcv{j}_50_2', '', 0.00108)
    Call_oscill('VOLT 0.015', f'C{j}:VDIV 5mv', f'C{j}:PAVA? MEAN', f'dcv{j}_50_3', '', 0.0012)
    Call_oscill('VOLT -0.015', f'C{j}:VDIV 5mv', f'C{j}:PAVA? MEAN', f'dcv{j}_50_4', '', 0.0012)
    Call_oscill('VOLT 0.03', f'C{j}:VDIV 10mv', f'C{j}:PAVA? MEAN', f'dcv{j}_50_5', '', 0.0014)
    Call_oscill('VOLT -0.03', f'C{j}:VDIV 10mv', f'C{j}:PAVA? MEAN', f'dcv{j}_50_6', '', 0.0014)
    Call_oscill('VOLT 0.06', f'C{j}:VDIV 20mv', f'C{j}:PAVA? MEAN', f'dcv{j}_50_7', '', 0.0018)
    Call_oscill('VOLT -0.06', f'C{j}:VDIV 20mv', f'C{j}:PAVA? MEAN', f'dcv{j}_50_8', '', 0.0018)
    Call_oscill('VOLT 0.15', f'C{j}:VDIV 50mv', f'C{j}:PAVA? MEAN', f'dcv{j}_50_9', '', 0.003)
    Call_oscill('VOLT -0.15', f'C{j}:VDIV 50mv', f'C{j}:PAVA? MEAN', f'dcv{j}_50_10', '', 0.003)
    Call_oscill('VOLT 0.3', f'C{j}:VDIV 100mv', f'C{j}:PAVA? MEAN', f'dcv{j}_50_11', '', 0.005)
    Call_oscill('VOLT -0.3', f'C{j}:VDIV 100mv', f'C{j}:PAVA? MEAN', f'dcv{j}_50_12', '', 0.005)
    Call_oscill('VOLT 0.6', f'C{j}:VDIV 200mv', f'C{j}:PAVA? MEAN', f'dcv{j}_50_13', '', 0.009)
    Call_oscill('VOLT -0.6', f'C{j}:VDIV 200mv', f'C{j}:PAVA? MEAN', f'dcv{j}_50_14', '', 0.009)
    Call_oscill('VOLT 1.5', f'C{j}:VDIV 500mv', f'C{j}:PAVA? MEAN', f'dcv{j}_50_15', '', 0.021)
    Call_oscill('VOLT -1.5', f'C{j}:VDIV 500mv', f'C{j}:PAVA? MEAN', f'dcv{j}_50_16', '', 0.021)
    Call_oscill('VOLT 3', f'C{j}:VDIV 1v', f'C{j}:PAVA? MEAN', f'dcv{j}_50_17', '', 0.041)
    Call_oscill('VOLT -3', f'C{j}:VDIV 1v', f'C{j}:PAVA? MEAN', f'dcv{j}_50_18', '', 0.041)
    Param_osc(f'{j}', 'ROUT:SIGN:IMP 1E+06', 'SCOP:SHAP DC', 'TDIV 1ms', f'C{j}:CPL DC1M')
    Call_oscill('VOLT 0.006', f'C{j}:VDIV 2mv', f'C{j}:PAVA? MEAN', f'dcv{j}_1_1', '', 0.00108)
    Call_oscill('VOLT -0.006', f'C{j}:VDIV 2mv', f'C{j}:PAVA? MEAN', f'dcv{j}_1_2', '', 0.00108)
    Call_oscill('VOLT 0.015', f'C{j}:VDIV 5mv', f'C{j}:PAVA? MEAN', f'dcv{j}_1_3', '', 0.0012)
    Call_oscill('VOLT -0.015', f'C{j}:VDIV 5mv', f'C{j}:PAVA? MEAN', f'dcv{j}_1_4', '', 0.0012)
    Call_oscill('VOLT 0.03', f'C{j}:VDIV 10mv', f'C{j}:PAVA? MEAN', f'dcv{j}_1_5', '', 0.0014)
    Call_oscill('VOLT -0.03', f'C{j}:VDIV 10mv', f'C{j}:PAVA? MEAN', f'dcv{j}_1_6', '', 0.0014)
    Call_oscill('VOLT 0.06', f'C{j}:VDIV 20mv', f'C{j}:PAVA? MEAN', f'dcv{j}_1_7', '', 0.0018)
    Call_oscill('VOLT -0.06', f'C{j}:VDIV 20mv', f'C{j}:PAVA? MEAN', f'dcv{j}_1_8', '', 0.0018)
    Call_oscill('VOLT 0.15', f'C{j}:VDIV 50mv', f'C{j}:PAVA? MEAN', f'dcv{j}_1_9', '', 0.003)
    Call_oscill('VOLT -0.15', f'C{j}:VDIV 50mv', f'C{j}:PAVA? MEAN', f'dcv{j}_1_10', '', 0.003)
    Call_oscill('VOLT 0.3', f'C{j}:VDIV 100mv', f'C{j}:PAVA? MEAN', f'dcv{j}_1_11', '', 0.005)
    Call_oscill('VOLT -0.3', f'C{j}:VDIV 100mv', f'C{j}:PAVA? MEAN', f'dcv{j}_1_12', '', 0.005)
    Call_oscill('VOLT 0.6', f'C{j}:VDIV 200mv', f'C{j}:PAVA? MEAN', f'dcv{j}_1_13', '', 0.009)
    Call_oscill('VOLT -0.6', f'C{j}:VDIV 200mv', f'C{j}:PAVA? MEAN', f'dcv{j}_1_14', '', 0.009)
    Call_oscill('VOLT 1.5', f'C{j}:VDIV 500mv', f'C{j}:PAVA? MEAN', f'dcv{j}_1_15', '', 0.021)
    Call_oscill('VOLT -1.5', f'C{j}:VDIV 500mv', f'C{j}:PAVA? MEAN', f'dcv{j}_1_16', '', 0.021)
    Call_oscill('VOLT 3', f'C{j}:VDIV 1v', f'C{j}:PAVA? MEAN', f'dcv{j}_1_17', '', 0.041)
    Call_oscill('VOLT -3', f'C{j}:VDIV 1v', f'C{j}:PAVA? MEAN', f'dcv{j}_1_18', '', 0.041)
    Call_oscill('VOLT 6', f'C{j}:VDIV 2v', f'C{j}:PAVA? MEAN', f'dcv{j}_1_19', '', 0.081)
    Call_oscill('VOLT -6', f'C{j}:VDIV 2v', f'C{j}:PAVA? MEAN', f'dcv{j}_1_20', '', 0.081)
    Call_oscill('VOLT 15', f'C{j}:VDIV 5v', f'C{j}:PAVA? MEAN', f'dcv{j}_1_21', '', 0.201)
    Call_oscill('VOLT -15', f'C{j}:VDIV 5v', f'C{j}:PAVA? MEAN', f'dcv{j}_1_22', '', 0.201)
    Call_oscill('VOLT 30', f'C{j}:VDIV 10v', f'C{j}:PAVA? MEAN', f'dcv{j}_1_23', '', 0.401)
    Call_oscill('VOLT -30', f'C{j}:VDIV 10v', f'C{j}:PAVA? MEAN', f'dcv{j}_1_24', '', 0.401)
    # ofset
    Param_osc(f'{j}', 'ROUT:SIGN:IMP 1E+06', 'SCOP:SHAP DC', 'TDIV 1ms', f'C{j}:CPL DC50')
    Call_oscill('VOLT 0.5', f'C{j}:VDIV 2mv', f'C{j}:PAVA? MEAN', f'odcv{j}_50_1', '-0.5', 0.00866)
    Call_oscill('VOLT -0.5', f'C{j}:VDIV 2mv', f'C{j}:PAVA? MEAN', f'odcv{j}_50_2', '0.5', 0.00866)
    Call_oscill('VOLT 1.4', f'C{j}:VDIV 5mv', f'C{j}:PAVA? MEAN', f'odcv{j}_50_3', '-1.4', 0.0224)
    Call_oscill('VOLT -1.4', f'C{j}:VDIV 5mv', f'C{j}:PAVA? MEAN', f'odcv{j}_50_4', '1.4', 0.0224)
    Call_oscill('VOLT 2.8', f'C{j}:VDIV 10mv', f'C{j}:PAVA? MEAN', f'odcv{j}_50_5', '-2.8', 0.0438)
    Call_oscill('VOLT -2.8', f'C{j}:VDIV 10mv', f'C{j}:PAVA? MEAN', f'odcv{j}_50_6', '2.8', 0.0438)
    Call_oscill('VOLT 4', f'C{j}:VDIV 20mv', f'C{j}:PAVA? MEAN', f'odcv{j}_50_7', '-4', 0.0626)
    Call_oscill('VOLT -4', f'C{j}:VDIV 20mv', f'C{j}:PAVA? MEAN', f'odcv{j}_50_8', '4', 0.0626)
    Param_osc(f'{j}', 'ROUT:SIGN:IMP 1E+06', 'SCOP:SHAP DC', 'TDIV 1ms', f'C{j}:CPL DC1M')
    Call_oscill('VOLT 0.5', f'C{j}:VDIV 2mv', f'C{j}:PAVA? MEAN', f'odcv{j}_1_1', '-0.5', 0.00866)
    Call_oscill('VOLT -0.5', f'C{j}:VDIV 2mv', f'C{j}:PAVA? MEAN', f'odcv{j}_1_2', '0.5', 0.00866)
    Call_oscill('VOLT 1.4', f'C{j}:VDIV 5mv', f'C{j}:PAVA? MEAN', f'odcv{j}_1_3', '-1.4', 0.0224)
    Call_oscill('VOLT -1.4', f'C{j}:VDIV 5mv', f'C{j}:PAVA? MEAN', f'odcv{j}_1_4', '1.4', 0.0224)
    Call_oscill('VOLT 2.8', f'C{j}:VDIV 10mv', f'C{j}:PAVA? MEAN', f'odcv{j}_1_5', '-2.8', 0.0438)
    Call_oscill('VOLT -2.8', f'C{j}:VDIV 10mv', f'C{j}:PAVA? MEAN', f'odcv{j}_1_6', '2.8', 0.0438)
    Call_oscill('VOLT 6', f'C{j}:VDIV 20mv', f'C{j}:PAVA? MEAN', f'odcv{j}_1_7', '-6', 0.0926)
    Call_oscill('VOLT -6', f'C{j}:VDIV 20mv', f'C{j}:PAVA? MEAN', f'odcv{j}_1_8', '6', 0.0926)
    Call_oscill('VOLT 60', f'C{j}:VDIV 200mv', f'C{j}:PAVA? MEAN', f'odcv{j}_1_9', '-60', 0.9026)
    Call_oscill('VOLT -60', f'C{j}:VDIV 200mv', f'C{j}:PAVA? MEAN', f'odcv{j}_1_10', '60', 0.9026)
    Call_oscill('VOLT 160', f'C{j}:VDIV 10v', f'C{j}:PAVA? MEAN', f'odcv{j}_1_11', '-160', 3.201)
    Call_oscill('VOLT -160', f'C{j}:VDIV 10v', f'C{j}:PAVA? MEAN', f'odcv{j}_1_12', '160', 3.201)
    # band
    Reset()
    Param_osc(f'{j}', 'ROUT:SIGN:IMP 50', 'SCOP:SHAP SIN', 'TDIV 100US', f'C{j}:CPL DC50')
    Call_oscill('VOLT 0.01', f'C{j}:VDIV 2mv', f'C{j}:PAVA? PKPK', f'bw{j}_50_1', 'FREQ:FIX 50E+03', 1000)
    Call_oscill('VOLT 0.03', f'C{j}:VDIV 5mv', f'C{j}:PAVA? PKPK', f'bw{j}_50_2', 'FREQ:FIX 50E+03', 1000)
    Call_oscill('VOLT 0.06', f'C{j}:VDIV 10mv', f'C{j}:PAVA? PKPK', f'bw{j}_50_3', 'FREQ:FIX 50E+03', 1000)
    Call_oscill('VOLT 0.12', f'C{j}:VDIV 20mv', f'C{j}:PAVA? PKPK', f'bw{j}_50_4', 'FREQ:FIX 50E+03', 1000)
    Call_oscill('VOLT 0.3', f'C{j}:VDIV 50mv', f'C{j}:PAVA? PKPK', f'bw{j}_50_5', 'FREQ:FIX 50E+03', 1000)
    Call_oscill('VOLT 0.6', f'C{j}:VDIV 100mv', f'C{j}:PAVA? PKPK', f'bw{j}_50_6', 'FREQ:FIX 50E+03', 1000)
    Call_oscill('VOLT 1.2', f'C{j}:VDIV 200mv', f'C{j}:PAVA? PKPK', f'bw{j}_50_7', 'FREQ:FIX 50E+03', 1000)
    Call_oscill('VOLT 3', f'C{j}:VDIV 500mv', f'C{j}:PAVA? PKPK', f'bw{j}_50_8', 'FREQ:FIX 50E+03', 1000)
    Call_oscill('VOLT 5.5', f'C{j}:VDIV 1', f'C{j}:PAVA? PKPK', f'bw{j}_50_9', 'FREQ:FIX 50E+03', 1000)
    Param_osc(f'{j}', 'ROUT:SIGN:IMP 1E+06', 'SCOP:SHAP SIN', 'TDIV 100US', f'C{j}:CPL DC1M')
    Call_oscill('VOLT 0.01', f'C{j}:VDIV 2mv', f'C{j}:PAVA? PKPK', f'bw{j}_1_1', 'FREQ:FIX 50E+03', 1000)
    Call_oscill('VOLT 0.03', f'C{j}:VDIV 5mv', f'C{j}:PAVA? PKPK', f'bw{j}_1_2', 'FREQ:FIX 50E+03', 1000)
    Call_oscill('VOLT 0.06', f'C{j}:VDIV 10mv', f'C{j}:PAVA? PKPK', f'bw{j}_1_3', 'FREQ:FIX 50E+03', 1000)
    Call_oscill('VOLT 0.12', f'C{j}:VDIV 20mv', f'C{j}:PAVA? PKPK', f'bw{j}_1_4', 'FREQ:FIX 50E+03', 1000)
    Call_oscill('VOLT 0.3', f'C{j}:VDIV 50mv', f'C{j}:PAVA? PKPK', f'bw{j}_1_5', 'FREQ:FIX 50E+03', 1000)
    Call_oscill('VOLT 0.6', f'C{j}:VDIV 100mv', f'C{j}:PAVA? PKPK', f'bw{j}_1_6', 'FREQ:FIX 50E+03', 1000)
    Call_oscill('VOLT 1.2', f'C{j}:VDIV 200mv', f'C{j}:PAVA? PKPK', f'bw{j}_1_7', 'FREQ:FIX 50E+03', 1000)
    Call_oscill('VOLT 3', f'C{j}:VDIV 500mv', f'C{j}:PAVA? PKPK', f'bw{j}_1_8', 'FREQ:FIX 50E+03', 1000)
    Call_oscill('VOLT 5.5', f'C{j}:VDIV 1', f'C{j}:PAVA? PKPK', f'bw{j}_1_9', 'FREQ:FIX 50E+03', 1000)
    Call_oscill('VOLT 5.5', f'C{j}:VDIV 2', f'C{j}:PAVA? PKPK', f'bw{j}_1_10', 'FREQ:FIX 50E+03', 1000)
    Call_oscill('VOLT 5.5', f'C{j}:VDIV 5', f'C{j}:PAVA? PKPK', f'bw{j}_1_11', 'FREQ:FIX 50E+03', 1000)
    Call_oscill('VOLT 5.5', f'C{j}:VDIV 10', f'C{j}:PAVA? PKPK', f'bw{j}_1_12', 'FREQ:FIX 50E+03', 1000)
    # trise
    Reset()
    Param_osc(f'{j}', 'ROUT:SIGN:IMP 50', 'SCOP:SHAP EDGE', 'TDIV 2ns', f'C{j}:CPL DC50')
    Call_oscill('VOLT 0.06', f'C{j}:VDIV 0.01', f'C{j}:PAVA? RISE', f'tr{j}_1', '0.03', 450)
    Call_oscill('VOLT 0.12', f'C{j}:VDIV 0.02', f'C{j}:PAVA? RISE', f'tr{j}_2', '0.06', 450)
    Call_oscill('VOLT 0.3', f'C{j}:VDIV 0.05', f'C{j}:PAVA? RISE', f'tr{j}_3', '0.15', 450)
    Call_oscill('VOLT 0.6', f'C{j}:VDIV 0.1', f'C{j}:PAVA? RISE', f'tr{j}_4', '0.3', 450)
    Call_oscill('VOLT 1.2', f'C{j}:VDIV 0.2', f'C{j}:PAVA? RISE', f'tr{j}_5', '0.6', 450)
    Call_oscill('VOLT 3', f'C{j}:VDIV 0.5', f'C{j}:PAVA? RISE', f'tr{j}_6', '1.5', 450)
    Call_oscill('VOLT 3', f'C{j}:VDIV 1', f'C{j}:PAVA? RISE', f'tr{j}_7', '1.5', 450)
    # period
    Reset()
    Param_osc(f'{j}', 'ROUT:SIGN:IMP 50', 'SCOP:SHAP SQU;, FREQ:FIX 0.01E+3', 'TDIV 100ms', f'C{j}:CPL DC50')
    Call_oscill('VOLT 0.6', f'C{j}:VDIV 0.1', f'C{j}:PAVA? PERIOD', f'ti{j}_1', '0.01E+3', 0.00000025)
    Param_osc(f'{j}', 'ROUT:SIGN:IMP 50', 'SCOP:SHAP SQU;, FREQ:FIX 1E+3', 'TDIV 1ms', f'C{j}:CPL DC50')
    Call_oscill('VOLT 0.6', f'C{j}:VDIV 0.1', f'C{j}:PAVA? PERIOD', f'ti{j}_2', '1E+3', 0.0000000025)
    Param_osc(f'{j}', 'ROUT:SIGN:IMP 50', 'SCOP:SHAP SIN;, FREQ:FIX 1E+6', 'TDIV 1us', f'C{j}:CPL DC50')
    Call_oscill('VOLT 0.6', f'C{j}:VDIV 0.1', f'C{j}:PAVA? PERIOD', f'ti{j}_3', '1E+6', 0.0000000000025)
    Param_osc(f'{j}', 'ROUT:SIGN:IMP 50', 'SCOP:SHAP SIN;, FREQ:FIX 0.01E+9', 'TDIV 100ns', f'C{j}:CPL DC50')
    Call_oscill('VOLT 0.6', f'C{j}:VDIV 0.1', f'C{j}:PAVA? PERIOD', f'ti{j}_4', '0.01E+9', 0.00000000000025)

Message('Калибровка завершена')
Clear_merge()
Reset()
