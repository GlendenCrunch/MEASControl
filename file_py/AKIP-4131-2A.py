# -*- coding: utf-8 -*-
for j in range(1,5,1):
    # dcv
    Supportfunc(f'message-Подключите формирователь без вешней нагрузки на КАНАЛ №{j} осциллографа')
    Supportfunc('resetoscil')
    Param_osc(f'{j}', 'ROUT:SIGN:IMP 1E+06', 'SCOP:SHAP DC', 'TDIV 1MS', '')
    Call_oscill('VOLT 0.006', f'C{j}:VDIV 0.002', f'C{j}:PAVA? MEAN', f'dcv{j}_1', '', 2.42)
    Call_oscill('VOLT -0.006', f'C{j}:VDIV 0.002', f'C{j}:PAVA? MEAN', f'dcv{j}_2', '', 2.42)
    Call_oscill('VOLT 0.015', f'C{j}:VDIV 0.005', f'C{j}:PAVA? MEAN', f'dcv{j}_3', '', 3.05)
    Call_oscill('VOLT -0.015', f'C{j}:VDIV 0.005', f'C{j}:PAVA? MEAN', f'dcv{j}_4', '', 3.05)
    Call_oscill('VOLT 0.03', f'C{j}:VDIV 0.01', f'C{j}:PAVA? MEAN', f'dcv{j}_5', '', 4.1)
    Call_oscill('VOLT -0.03', f'C{j}:VDIV 0.01', f'C{j}:PAVA? MEAN', f'dcv{j}_6', '', 4.1)
    Call_oscill('VOLT 0.06', f'C{j}:VDIV 0.02', f'C{j}:PAVA? MEAN', f'dcv{j}_7', '', 6.2)
    Call_oscill('VOLT -0.06', f'C{j}:VDIV 0.02', f'C{j}:PAVA? MEAN', f'dcv{j}_8', '', 6.2)
    Call_oscill('VOLT 0.15', f'C{j}:VDIV 0.05', f'C{j}:PAVA? MEAN', f'dcv{j}_9', '', 12.5)
    Call_oscill('VOLT -0.15', f'C{j}:VDIV 0.05', f'C{j}:PAVA? MEAN', f'dcv{j}_10', '', 12.5)
    Call_oscill('VOLT 0.3', f'C{j}:VDIV 0.1', f'C{j}:PAVA? MEAN', f'dcv{j}_11', '', 23)
    Call_oscill('VOLT -0.3', f'C{j}:VDIV 0.1', f'C{j}:PAVA? MEAN', f'dcv{j}_12', '', 23)
    Call_oscill('VOLT 0.6', f'C{j}:VDIV 0.2', f'C{j}:PAVA? MEAN', f'dcv{j}_13', '', 44)
    Call_oscill('VOLT -0.6', f'C{j}:VDIV 0.2', f'C{j}:PAVA? MEAN', f'dcv{j}_14', '', 44)
    Call_oscill('VOLT 1.5', f'C{j}:VDIV 0.5', f'C{j}:PAVA? MEAN', f'dcv{j}_15', '', 107)
    Call_oscill('VOLT -1.5', f'C{j}:VDIV 0.5', f'C{j}:PAVA? MEAN', f'dcv{j}_16', '', 107)
    Call_oscill('VOLT 3.0', f'C{j}:VDIV 1', f'C{j}:PAVA? MEAN', f'dcv{j}_17', '', 0.212)
    Call_oscill('VOLT -3.0', f'C{j}:VDIV 1', f'C{j}:PAVA? MEAN', f'dcv{j}_18', '', 0.212)
    Call_oscill('VOLT 6.0', f'C{j}:VDIV 2', f'C{j}:PAVA? MEAN', f'dcv{j}_19', '', 0.422)
    Call_oscill('VOLT -6.0', f'C{j}:VDIV 2', f'C{j}:PAVA? MEAN', f'dcv{j}_20', '', 0.422)
    Call_oscill('VOLT 15.0', f'C{j}:VDIV 5', f'C{j}:PAVA? MEAN', f'dcv{j}_21', '', 1.052)
    Call_oscill('VOLT -15.0', f'C{j}:VDIV 5', f'C{j}:PAVA? MEAN', f'dcv{j}_22', '', 1.052)
    Call_oscill('VOLT 30.0', f'C{j}:VDIV 10', f'C{j}:PAVA? MEAN', f'dcv{j}_23', '', 2.102)
    Call_oscill('VOLT -30.0', f'C{j}:VDIV 10', f'C{j}:PAVA? MEAN', f'dcv{j}_24', '', 2.102)
    # ofset
    Supportfunc('resetoscil')
    Param_osc(f'{j}', 'ROUT:SIGN:IMP 1E+06', 'SCOP:SHAP DC', 'TDIV 1MS', '')
    Call_oscill('VOLT 0.5', f'C{j}:VDIV 0.002', f'C{j}:PAVA? MEAN', f'odcv{j}_1', '-0.5', 0.0372)
    Call_oscill('VOLT -0.5', f'C{j}:VDIV 0.002', f'C{j}:PAVA? MEAN', f'odcv{j}_2', '0.5', 0.0372)
    Call_oscill('VOLT 1.2', f'C{j}:VDIV 0.05', f'C{j}:PAVA? MEAN', f'odcv{j}_3', '-1.2', 0.092)
    Call_oscill('VOLT -1.2', f'C{j}:VDIV 0.05', f'C{j}:PAVA? MEAN', f'odcv{j}_4', '1.2', 0.092)
    Call_oscill('VOLT 1.8', f'C{j}:VDIV 0.1', f'C{j}:PAVA? MEAN', f'odcv{j}_5', '-1.8', 0.14)
    Call_oscill('VOLT -1.8', f'C{j}:VDIV 0.1', f'C{j}:PAVA? MEAN', f'odcv{j}_6', '1.8', 0.14)
    Call_oscill('VOLT 10', f'C{j}:VDIV 0.2', f'C{j}:PAVA? MEAN', f'odcv{j}_7', '-10', 0.726)
    Call_oscill('VOLT -10', f'C{j}:VDIV 0.2', f'C{j}:PAVA? MEAN', f'odcv{j}_8', '10', 0.726)
    Call_oscill('VOLT 15', f'C{j}:VDIV 1', f'C{j}:PAVA? MEAN', f'odcv{j}_9', '-10', 1.172)
    Call_oscill('VOLT -15', f'C{j}:VDIV 1', f'C{j}:PAVA? MEAN', f'odcv{j}_10', '10', 1.172)
    Call_oscill('VOLT 100', f'C{j}:VDIV 2', f'C{j}:PAVA? MEAN', f'odcv{j}_11', '-100', 7.242)
    Call_oscill('VOLT -100', f'C{j}:VDIV 2', f'C{j}:PAVA? MEAN', f'odcv{j}_12', '100', 7.242)
    Call_oscill('VOLT 160', f'C{j}:VDIV 10', f'C{j}:PAVA? MEAN', f'odcv{j}_13', '-160', 12.4)
    Call_oscill('VOLT -160', f'C{j}:VDIV 10', f'C{j}:PAVA? MEAN', f'odcv{j}_14', '160', 12.4)
    # band
    Supportfunc('resetoscil')
    Param_osc(f'{j}', 'ROUT:SIGN:IMP 1E+06', 'SCOP:SHAP SIN', 'TDIV 10US', '')
    Call_oscill('VOLT 0.01', f'C{j}:VDIV 0.002', f'C{j}:PAVA? RMS', f'bw{j}_1', 'FREQ:FIX 50E+03', 200)
    Call_oscill('VOLT 0.03', f'C{j}:VDIV 0.005', f'C{j}:PAVA? RMS', f'bw{j}_2', 'FREQ:FIX 50E+03', 200)
    Call_oscill('VOLT 0.06', f'C{j}:VDIV 0.01', f'C{j}:PAVA? RMS', f'bw{j}_3', 'FREQ:FIX 50E+03', 200)
    Call_oscill('VOLT 0.12', f'C{j}:VDIV 0.02', f'C{j}:PAVA? RMS', f'bw{j}_4', 'FREQ:FIX 50E+03', 200)
    Call_oscill('VOLT 0.3', f'C{j}:VDIV 0.05', f'C{j}:PAVA? RMS', f'bw{j}_5', 'FREQ:FIX 50E+03', 200)
    Call_oscill('VOLT 0.6', f'C{j}:VDIV 0.1', f'C{j}:PAVA? RMS', f'bw{j}_6', 'FREQ:FIX 50E+03', 200)
    Call_oscill('VOLT 1.2', f'C{j}:VDIV 0.2', f'C{j}:PAVA? RMS', f'bw{j}_7', 'FREQ:FIX 50E+03', 200)
    Call_oscill('VOLT 3', f'C{j}:VDIV 0.5', f'C{j}:PAVA? RMS', f'bw{j}_8', 'FREQ:FIX 50E+03', 200)
    Call_oscill('VOLT 5.5', f'C{j}:VDIV 1', f'C{j}:PAVA? RMS', f'bw{j}_9', 'FREQ:FIX 50E+03', 200)
    Call_oscill('VOLT 5.5', f'C{j}:VDIV 2', f'C{j}:PAVA? RMS', f'bw{j}_10', 'FREQ:FIX 50E+03', 200)
    Call_oscill('VOLT 5.5', f'C{j}:VDIV 5', f'C{j}:PAVA? RMS', f'bw{j}_11', 'FREQ:FIX 50E+03', 200)
    # trise
    Supportfunc(f'message-Подключите внешнию нагрузку 50 Ом на КАНАЛ №{j} осциллографа')
    Supportfunc('resetoscil')
    Param_osc(f'{j}', 'ROUT:SIGN:IMP 50', 'SCOP:SHAP EDGE', 'TDIV 2.5E-9', '')
    Call_oscill('VOLT 0.01', f'C{j}:VDIV 0.002', f'C{j}:PAVA? RISE', f'tr{j}_1', '0.005', 1.8)
    Call_oscill('VOLT 0.03', f'C{j}:VDIV 0.005', f'C{j}:PAVA? RISE', f'tr{j}_2', '0.014', 1.8)
    Call_oscill('VOLT 0.06', f'C{j}:VDIV 0.01', f'C{j}:PAVA? RISE', f'tr{j}_3', '0.03', 1.8)
    Call_oscill('VOLT 0.11', f'C{j}:VDIV 0.02', f'C{j}:PAVA? RISE', f'tr{j}_4', '0.06', 1.8)
    Call_oscill('VOLT 0.27', f'C{j}:VDIV 0.05', f'C{j}:PAVA? RISE', f'tr{j}_5', '0.15', 1.8)
    Call_oscill('VOLT 0.55', f'C{j}:VDIV 0.1', f'C{j}:PAVA? RISE', f'tr{j}_6', '0.3', 1.8)
    Call_oscill('VOLT 1.2', f'C{j}:VDIV 0.2', f'C{j}:PAVA? RISE', f'tr{j}_7', '0.6', 1.8)
    Call_oscill('VOLT 2.7', f'C{j}:VDIV 0.5', f'C{j}:PAVA? RISE', f'tr{j}_8', '1.5', 1.8)
    Call_oscill('VOLT 3.1', f'C{j}:VDIV 1', f'C{j}:PAVA? RISE', f'tr{j}_9', '3', 1.8)

Supportfunc('message-Калибровка завершена')
Clear_merge()
Supportfunc('resetoscil')
